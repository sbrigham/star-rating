"use strict";angular.module("starRatingApp",["templates"]),angular.module("starRatingApp",["sbRatingDirective"]).controller("MainCtrl",["$scope","Rating",function(a,t){a.max||(a.max=5),a.$watch(function(){return a.$parent.initrating},function(t){void 0!=t&&(a.rating=t,a.setStars(t))}),a.stars=[];for(var r={"class":"star"},n=1;n<a.max+1;n++){var s=angular.copy(r);s.star_num=n,a.stars.push(s)}a.hoverStar=function(t){angular.forEach(a.stars,function(a){a.class="star"}),angular.forEach(a.stars,function(a){a.star_num<=t.star_num&&(a.class="rating-star-active")})},a.leaveHoverStar=function(t){null==a.rating?angular.forEach(a.stars,function(a){a.class="star"}):angular.forEach(a.stars,function(r){r.star_num>a.rating?r.class="star":t.star_num<a.rating&&(r.class="rating-star-active")})},a.clickStar=function(t){if(a.rating==t.star_num){a.rating=null;for(var r in a.stars)r.class=""}else a.rating=t.star_num,a.saveRating(a.rating),angular.forEach(a.stars,function(t){t.star_num<=a.rating&&(t.class="rating-star-active")})},a.saveRating=function(r){t.saveRating(a.$parent.$parent.episode_id,r)},a.setStars=function(t){angular.forEach(a.stars,function(a){a.star_num<=t&&(a.class="rating-star-active")})}}]),angular.module("sbRatingDirective",[]).directive("starRating",function(){return{restrict:"E",templateUrl:"partials/star-rating.html",scope:{max:"=",initrating:"="}}}).factory("Rating",["$http",function(a){return{saveRating:function(t,r){a.post("/api/episode/"+t+"/rating",{rating:r}).success(function(){}).error(function(){})}}}]),angular.module("templates",[]).run(["$templateCache",function(a){a.put("partials/star-rating.html",'<div ng-controller="MainCtrl" id="sb-rating">\n    <div class="rating">\n        <span class="sb-stars">\n            <i class="fa fa-star sb-star" ng-mouseleave="leaveHoverStar(star)" ng-mouseover="hoverStar(star)" ng-class="star.class" ng-click="clickStar(star)" ng-repeat="star in stars"></i>\n        </span>\n    </div>\n</div>')}]);